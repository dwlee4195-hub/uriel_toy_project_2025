<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Airport Security - ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Custom Dark Theme Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-bg': '#0f172a',
                        'dark-secondary': '#1e293b',
                        'dark-tertiary': '#334155',
                        'primary-blue': '#3b82f6',
                        'primary-green': '#10b981'
                    }
                }
            }
        }
    </script>

    <style>
        /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b;
        }
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* ë¼ì´ë‹¤ ë§µ ìŠ¤íƒ€ì¼ */
        .lidar-map {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f172a 100%);
            position: relative;
            overflow: hidden;
        }

        .lidar-grid {
            background-image:
                    linear-gradient(rgba(34, 197, 94, 0.1) 1px, transparent 1px),
                    linear-gradient(90deg, rgba(34, 197, 94, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .detection-point {
            position: absolute;
            animation: pulse 2s infinite;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .detection-point:hover {
            transform: scale(1.2);
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }

        .status-indicator {
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-dark-bg text-gray-200 min-h-screen flex">

<!-- ì‚¬ì´ë“œë°” ì»¨í…Œì´ë„ˆ -->
<div id="sidebar-container"></div>

<!-- ì‚¬ì´ë“œë°” ìŠ¤í¬ë¦½íŠ¸ ì¦‰ì‹œ ë¡œë“œ -->
<script src="js/sidebar-template.js"></script>

<!-- ë°ì´í„° ë§¤ë‹ˆì € ë° ê³µí†µ ì¸ì¦ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
<script src="js/notification.js"></script>
<script src="js/data-manager.js"></script>
<script src="js/common-auth.js"></script>

<!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
<main class="flex-1 overflow-y-auto">
    <!-- í—¤ë” ì˜ì—­ (ê³µí†µ í—¤ë”) -->
    <div id="header-container"></div>

    <!-- ëŒ€ì‹œë³´ë“œ ë©”ì¸ ì½˜í…ì¸  -->
    <section class="p-4">
        <!-- ìƒë‹¨ í†µê³„ ì¹´ë“œë“¤ -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            <!-- ì‹ ê·œ ê²½ê³  -->
            <div class="bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-red-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-400">ì‹ ê·œ ê²½ê³ </p>
                        <p id="pending-count" class="text-3xl font-bold text-red-600">0</p>
                        <p class="text-xs text-gray-500 mt-1">ëŒ€ê¸° ì¤‘ì¸ ì‚¬ê±´</p>
                    </div>
                    <div class="bg-red-100 p-3 rounded-full">
                        <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- ì¶œë™ ì¤‘ -->
            <div class="bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-orange-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-400">ì¶œë™ ì¤‘</p>
                        <p id="in-progress-count" class="text-3xl font-bold text-orange-600">0</p>
                        <p class="text-xs text-gray-500 mt-1">ì²˜ë¦¬ ì§„í–‰ ì¤‘</p>
                    </div>
                    <div class="bg-orange-100 p-3 rounded-full">
                        <i class="fas fa-users text-orange-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- ì²˜ë¦¬ ì™„ë£Œ -->
            <div class="bg-gray-800 rounded-xl shadow-lg p-4 border-l-4 border-green-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-400">ì²˜ë¦¬ ì™„ë£Œ</p>
                        <p id="resolved-count" class="text-3xl font-bold text-green-600">0</p>
                        <p class="text-xs text-gray-500 mt-1">ì´ í•´ê²° ê±´ìˆ˜</p>
                    </div>
                    <div class="bg-green-900/30 p-3 rounded-full">
                        <i class="fas fa-check-circle text-green-500 text-xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- ë©”ì¸ ëŒ€ì‹œë³´ë“œ ì˜ì—­ -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
            <!-- ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ (2/3 ì˜ì—­) -->
            <div class="lg:col-span-2 bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                <!-- í—¤ë” -->
                <div class="p-4 border-b border-gray-700">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="bg-blue-900/30 p-2 rounded-lg mr-3">
                                <i class="fas fa-map-marked-alt text-blue-500"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-200">ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</h3>
                                <p class="text-sm text-gray-400">ê³µí•­ í„°ë¯¸ë„ ë°©ì¹˜ë¬¼í’ˆ ê°ì§€ í˜„í™©</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-red-500 rounded-full mr-2 status-indicator"></div>
                                <span class="text-xs text-gray-400">ì‹¤ì‹œê°„ ì—°ê²°</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
                <div class="flex border-b border-gray-700">
                    <button id="lidar-tab" class="flex-1 px-4 py-2 text-sm font-medium text-blue-400 bg-dark-tertiary border-b-2 border-blue-500 transition-colors" onclick="switchTab('lidar')">
                        <i class="fas fa-radar mr-2"></i>
                        ë¼ì´ë‹¤ ë§µ
                    </button>
                    <button id="cctv-tab" class="flex-1 px-4 py-2 text-sm font-medium text-gray-500 hover:text-gray-300 transition-colors" onclick="switchTab('cctv')">
                        <i class="fas fa-video mr-2"></i>
                        CCTV í˜„í™©
                    </button>
                </div>

                <!-- ë¼ì´ë‹¤ ë§µ ì½˜í…ì¸  -->
                <div id="lidar-content" class="tab-content">
                    <div class="bg-gray-100 h-100 flex items-center justify-center">
                        <div class="text-center">
                            <img src="image/ê¹€í¬-êµ­ì œì„ -1ì¸µ-ë¼ì´ë‹¤-ë™ì˜ìƒ.gif" style="width:1550px; height:550px;">
                        </div>
                    </div>
                </div>

                <!-- CCTV í˜„í™© ì½˜í…ì¸  -->
                <div id="cctv-content" class="tab-content hidden">
                    <div class="bg-gray-100 h-100 flex items-center justify-center">
                        <div class="text-center">
                            <img src="image/cctv-ë²„íŠ¼-ëˆŒë €ì„ë•Œ-ì˜ìƒ.gif" style="width:1550px; height:550px;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- ìš°ì¸¡ í†µê³„ ë° ì •ë³´ íŒ¨ë„ (1/3 ì˜ì—­) -->
            <div class="space-y-4">

                <!-- ìµœê·¼ ê²½ê³  ì•Œë¦¼ -->
                <div class="bg-gray-800 rounded-xl shadow-lg p-4">
                    <div class="flex items-center mb-4">
                        <div class="bg-red-900/30 p-2 rounded-lg mr-3">
                            <i class="fas fa-bell text-red-500"></i>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-gray-200">ìµœê·¼ ê²½ê³ </h4>
                            <p class="text-sm text-gray-400">ì‹¤ì‹œê°„ ì•Œë¦¼</p>
                        </div>
                    </div>
                    <div id="recent-alerts" class="space-y-3">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                    </div>
                </div>

                <!-- ì‹œê°„ëŒ€ë³„ ê°ì§€ ì¶”ì´ -->
                <div class="bg-gray-800 rounded-xl shadow-lg p-4">
                    <div class="flex items-center mb-4">
                        <div class="bg-purple-900/30 p-2 rounded-lg mr-3">
                            <i class="fas fa-chart-bar text-purple-500"></i>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-gray-200">ì‹¤ì‹œê°„ ë°œìƒ ê±´ìˆ˜ ê·¸ë˜í”„</h4>
                            <p class="text-sm text-gray-400">ì§€ë‚œ 24ì‹œê°„</p>
                        </div>
                    </div>
                    <div class="h-48">
                        <canvas id="hourlyChart"></canvas>
                    </div>
                </div>

                <!-- ìœ„í—˜ë„ë³„ ë¶„í¬ -->
                <div class="bg-gray-800 rounded-xl shadow-lg p-4">
                    <div class="flex items-center mb-4">
                        <div class="bg-yellow-900/30 p-2 rounded-lg mr-3">
                            <i class="fas fa-shield-alt text-yellow-500"></i>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-gray-200">ìœ„í—˜ë„ë³„ ë¶„í¬</h4>
                            <p class="text-sm text-gray-400">í˜„ì¬ í™œì„± ê²½ê³ </p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                                <span class="text-sm text-gray-300">ê³ ìœ„í—˜</span>
                            </div>
                            <span id="high-risk" class="text-sm font-bold text-red-600">3ê±´</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-orange-500 rounded-full mr-2"></div>
                                <span class="text-sm text-gray-300">ì¤‘ìœ„í—˜</span>
                            </div>
                            <span id="medium-risk" class="text-sm font-bold text-orange-600">8ê±´</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></div>
                                <span class="text-sm text-gray-300">ì €ìœ„í—˜</span>
                            </div>
                            <span id="low-risk" class="text-sm font-bold text-yellow-600">12ê±´</span>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </section>
</main>

<!-- JavaScript -->
<script>
    let detectionChart = null;

    // í˜ì´ì§€ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
        initializeDashboard();

        // 3ì´ˆë§ˆë‹¤ ë°ì´í„° ì—…ë°ì´íŠ¸
        setInterval(updateDashboard, 3000);
    });

    // íƒ­ ì „í™˜ í•¨ìˆ˜
    function switchTab(tabName) {
        // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
        document.getElementById('lidar-tab').className = 'flex-1 px-4 py-2 text-sm font-medium text-gray-500 hover:text-gray-300 transition-colors';
        document.getElementById('cctv-tab').className = 'flex-1 px-4 py-2 text-sm font-medium text-gray-500 hover:text-gray-300 transition-colors';

        // ëª¨ë“  ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
        document.getElementById('lidar-content').classList.add('hidden');
        document.getElementById('cctv-content').classList.add('hidden');

        // ì„ íƒëœ íƒ­ í™œì„±í™”
        if (tabName === 'lidar') {
            document.getElementById('lidar-tab').className = 'flex-1 px-4 py-2 text-sm font-medium text-blue-400 bg-dark-tertiary border-b-2 border-blue-500 transition-colors';
            document.getElementById('lidar-content').classList.remove('hidden');
        } else if (tabName === 'cctv') {
            document.getElementById('cctv-tab').className = 'flex-1 px-4 py-2 text-sm font-medium text-blue-400 bg-dark-tertiary border-b-2 border-blue-500 transition-colors';
            document.getElementById('cctv-content').classList.remove('hidden');
        }
    }

    // ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
    function initializeDashboard() {
        updateStatistics();
        createHourlyChart();
        updateRecentAlerts();
    }

    // í†µê³„ ì—…ë°ì´íŠ¸
    function updateDashboard() {
        updateStatistics();
        updateRecentAlerts();
    }

    // ìƒë‹¨ í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸
    function updateStatistics() {
        const incidents = JSON.parse(localStorage.getItem('incidents') || '[]');
        const teams = JSON.parse(localStorage.getItem('teams') || '[]');

        // ìƒíƒœë³„ ì‚¬ê±´ ê°œìˆ˜ ê³„ì‚°
        const pendingCount = incidents.filter(i => i.status === 'pending').length;
        const inProgressCount = incidents.filter(i => i.status === 'assigned' || i.status === 'in_progress').length;
        const resolvedCount = incidents.filter(i => i.status === 'resolved').length;

        document.getElementById('pending-count').textContent = pendingCount.toLocaleString();
        document.getElementById('in-progress-count').textContent = inProgressCount.toLocaleString();
        document.getElementById('resolved-count').textContent = resolvedCount.toLocaleString();

        // ìœ„í—˜ë„ë³„ ë¶„í¬ ì—…ë°ì´íŠ¸ (ë¯¸í•´ê²° ê±´ë§Œ)
        const activeIncidents = incidents.filter(i => i.status !== 'resolved');
        const highRisk = activeIncidents.filter(i => i.riskLevel === 'high').length;
        const mediumRisk = activeIncidents.filter(i => i.riskLevel === 'medium').length;
        const lowRisk = activeIncidents.filter(i => i.riskLevel === 'low').length;

        document.getElementById('high-risk').textContent = `${highRisk}ê±´`;
        document.getElementById('medium-risk').textContent = `${mediumRisk}ê±´`;
        document.getElementById('low-risk').textContent = `${lowRisk}ê±´`;
    }


    // ì‹œê°„ëŒ€ë³„ ì°¨íŠ¸ ìƒì„±
    function createHourlyChart() {
        // Chart.js ê¸°ë³¸ ì„¤ì •
        Chart.defaults.color = '#9ca3af';
        Chart.defaults.borderColor = '#374151';

        const ctx = document.getElementById('hourlyChart').getContext('2d');

        // ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ ì‹œê°„ëŒ€ë³„ í†µê³„
        const incidents = JSON.parse(localStorage.getItem('incidents') || '[]');
        const hourlyData = Array.from({length: 24}, () => 0);

        // ì˜¤ëŠ˜ ë°œìƒí•œ ì‚¬ê±´ë“¤ì„ ì‹œê°„ëŒ€ë³„ë¡œ ì§‘ê³„
        const today = new Date().toDateString();
        incidents.forEach(incident => {
            const incidentDate = new Date(incident.detectedAt);
            if (incidentDate.toDateString() === today) {
                const hour = incidentDate.getHours();
                hourlyData[hour]++;
            }
        });

        // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ìƒ˜í”Œ ë°ì´í„°ë¡œ ì‹œê°í™”
        const hasData = hourlyData.some(count => count > 0);
        if (!hasData) {
            // ê³¼ê±° ë°ì´í„° ì‹œë®¬ë ˆì´ì…˜ (9ì‹œ-18ì‹œ ì—…ë¬´ì‹œê°„ì— ë” ë§ì€ ì‚¬ê±´)
            for (let i = 0; i < 24; i++) {
                if (i >= 6 && i <= 22) {
                    hourlyData[i] = Math.floor(Math.random() * 3) + (i >= 9 && i <= 18 ? 2 : 1);
                } else {
                    hourlyData[i] = Math.floor(Math.random() * 2);
                }
            }
        }

        if (detectionChart) {
            detectionChart.destroy();
        }

        detectionChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Array.from({length: 24}, (_, i) => i + 'ì‹œ'),
                datasets: [{
                    label: 'ê°ì§€ ê±´ìˆ˜',
                    data: hourlyData,
                    backgroundColor: 'rgba(59, 130, 246, 0.6)',
                    borderColor: 'rgba(59, 130, 246, 1)',
                    borderWidth: 1,
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            stepSize: 10
                        }
                    },
                    x: {
                        ticks: {
                            maxTicksLimit: 12
                        }
                    }
                }
            }
        });
    }

    // ì¤‘ë³µ ë°©ì§€ìš© Set
    const shownToastIds = new Set();

    function showToast(message, riskLevel, id) {
      // ì´ë¯¸ í‘œì‹œëœ ê²½ìš° ì¤‘ë³µ ë°©ì§€
      if (id && shownToastIds.has(id)) return;
      if (id) shownToastIds.add(id);

      const container = document.getElementById('toast-container');

      // ìœ„í—˜ë„ë³„ ì»¬ëŸ¬ (ë‹¤í¬ëª¨ë“œ ìµœì í™”)
      let riskColor = 'bg-yellow-600 text-gray-900 shadow-lg';
      if (riskLevel === 'high') riskColor = 'bg-red-700 text-white shadow-lg shadow-red-500/50';
      else if (riskLevel === 'medium') riskColor = 'bg-orange-600 text-white shadow-lg shadow-orange-500/50';

      const toast = document.createElement('div');
      toast.className = `flex items-center p-3 rounded-lg ${riskColor} animate-slide-in transform transition-all duration-300`;
      toast.style.boxShadow = '0 0 10px rgba(255,0,0,0.5)';
      toast.innerHTML = `
            <i class="fas fa-exclamation-circle mr-2"></i>
            <span>${message}</span>
        `;

      container.appendChild(toast);

      // í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
      toast.animate([
        { transform: 'scale(1)', opacity: 1 },
        { transform: 'scale(1.1)', opacity: 0.8 },
        { transform: 'scale(1)', opacity: 1 }
      ], {
        duration: 1500,
        iterations: 1
      });

      // 5ì´ˆ í›„ ìë™ ì œê±°
      setTimeout(() => {
        toast.classList.add('opacity-0', 'translate-x-20');
        setTimeout(() => {
          toast.remove();
          if (id) shownToastIds.delete(id);
        }, 500);
      }, 5000);
    }

    function updateRecentAlerts() {
      const incidents = JSON.parse(localStorage.getItem('incidents') || '[]');
      const recentIncidents = incidents
      .filter(i => i.status === 'pending')
      .sort((a, b) => new Date(b.detectedAt) - new Date(a.detectedAt))
      .slice(0, 3);

      const container = document.getElementById('recent-alerts');

      if (recentIncidents.length === 0) {
        container.innerHTML = '<p class="text-sm text-gray-500 text-center py-4">í˜„ì¬ í™œì„± ê²½ê³ ê°€ ì—†ìŠµë‹ˆë‹¤</p>';
        return;
      }

      container.innerHTML = recentIncidents.map(incident => {
        const time = new Date(incident.detectedAt).toLocaleTimeString('ko-KR', {
          hour: '2-digit',
          minute: '2-digit'
        });

        // í† ìŠ¤íŠ¸ í‘œì‹œ (ì¤‘ë³µ ë°©ì§€)
        showToast(`${incident.location}ì—ì„œ ${incident.objectType} ê°ì§€ë¨`, incident.riskLevel, incident.id);

        let riskColor = 'text-yellow-500 bg-yellow-900/30';
        if (incident.riskLevel === 'high') riskColor = 'text-red-500 bg-red-900/30';
        else if (incident.riskLevel === 'medium') riskColor = 'text-orange-500 bg-orange-900/30';

        return `
                <div class="flex items-center justify-between p-3 bg-gray-900 rounded-lg hover:bg-gray-900 transition-colors cursor-pointer"
                     onclick="window.location.href='incident-detail.html?id=${incident.id}'">
                    <div class="flex items-center">
                        <div class="w-2 h-2 bg-red-500 rounded-full mr-3 animate-pulse"></div>
                        <div>
                            <p class="text-sm font-medium text-gray-200">${incident.location}</p>
                            <p class="text-xs text-gray-400">${incident.objectType}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="${riskColor} text-xs px-2 py-1 rounded-full font-medium">
                            ${incident.riskLevel === 'high' ? 'ê³ ìœ„í—˜' : incident.riskLevel === 'medium' ? 'ì¤‘ìœ„í—˜' : 'ì €ìœ„í—˜'}
                        </span>
                        <p class="text-xs text-gray-500 mt-1">${time}</p>
                    </div>
                </div>
            `;
      }).join('');
    }

// function showToast(message, riskLevel) {
    //     const container = document.getElementById('toast-container');
    //
    //     let riskColor = 'bg-yellow-600';
    //     if (riskLevel === 'high') riskColor = 'bg-red-600';
    //     else if (riskLevel === 'medium') riskColor = 'bg-orange-600';
    //
    //     const toast = document.createElement('div');
    //     toast.className = `flex items-center p-3 rounded-lg shadow-lg text-white ${riskColor} animate-slide-in`;
    //     toast.innerHTML = `
    //     <i class="fas fa-exclamation-circle mr-2"></i>
    //     <span>${message}</span>
    // `;
    //
    //     container.appendChild(toast);
    //
    //     // 5ì´ˆ í›„ ìë™ ì œê±°
    //     setTimeout(() => {
    //         toast.classList.add('opacity-0', 'translate-x-20', 'transition-all', 'duration-500');
    //         setTimeout(() => toast.remove(), 500);
    //     }, 5000);
    // }
    //
    //
    // function updateRecentAlerts() {
    //     const incidents = JSON.parse(localStorage.getItem('incidents') || '[]');
    //     const recentIncidents = incidents
    //     .filter(i => i.status === 'pending')
    //     .sort((a, b) => new Date(b.detectedAt) - new Date(a.detectedAt))
    //     .slice(0, 3);
    //
    //     const container = document.getElementById('recent-alerts');
    //
    //     if (recentIncidents.length === 0) {
    //         container.innerHTML = '<p class="text-sm text-gray-500 text-center py-4">í˜„ì¬ í™œì„± ê²½ê³ ê°€ ì—†ìŠµë‹ˆë‹¤</p>';
    //         return;
    //     }
    //
    //     container.innerHTML = recentIncidents.map(incident => {
    //         const time = new Date(incident.detectedAt).toLocaleTimeString('ko-KR', {
    //             hour: '2-digit',
    //             minute: '2-digit'
    //         });
    //
    //         // ğŸš¨ íŒì—… ì•Œë¦¼ ì‹¤í–‰
    //         showToast(`${incident.location}ì—ì„œ ${incident.objectType} ê°ì§€ë¨`, incident.riskLevel);
    //
    //         let riskColor = 'text-yellow-500 bg-yellow-900/30';
    //         if (incident.riskLevel === 'high') riskColor = 'text-red-500 bg-red-900/30';
    //         else if (incident.riskLevel === 'medium') riskColor = 'text-orange-500 bg-orange-900/30';
    //
    //         return `
    //         <div class="flex items-center justify-between p-3 bg-gray-900 rounded-lg hover:bg-gray-900 transition-colors cursor-pointer"
    //              onclick="window.location.href='incident-detail.html?id=${incident.id}'">
    //             <div class="flex items-center">
    //                 <div class="w-2 h-2 bg-red-500 rounded-full mr-3 animate-pulse"></div>
    //                 <div>
    //                     <p class="text-sm font-medium text-gray-200">${incident.location}</p>
    //                     <p class="text-xs text-gray-400">${incident.objectType}</p>
    //                 </div>
    //             </div>
    //             <div class="text-right">
    //                 <span class="${riskColor} text-xs px-2 py-1 rounded-full font-medium">
    //                     ${incident.riskLevel === 'high' ? 'ê³ ìœ„í—˜' : incident.riskLevel === 'medium' ? 'ì¤‘ìœ„í—˜' : 'ì €ìœ„í—˜'}
    //                 </span>
    //                 <p class="text-xs text-gray-500 mt-1">${time}</p>
    //             </div>
    //         </div>
    //     `;
    //     }).join('');
    // }
</script>

<!-- ê³µí†µ í—¤ë” ìŠ¤í¬ë¦½íŠ¸ -->
<script src="js/common-header.js"></script>

<!-- í˜ì´ì§€ ì´ˆê¸°í™” -->
<script>
    // í—¤ë” ì´ˆê¸°í™”
    CommonHeader.init('header-container',
        '<i class="fas fa-tachometer-alt mr-3 text-primary-blue"></i>ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ',
        'ê³µí•­ ë³´ì•ˆ í†µí•© ê´€ì œ í˜„í™©');
</script>
<!-- íŒì—… ì•Œë¦¼ ì»¨í…Œì´ë„ˆ -->
<div id="toast-container" class="fixed top-4 right-4 space-y-2 z-50"></div>
</body>
</html>